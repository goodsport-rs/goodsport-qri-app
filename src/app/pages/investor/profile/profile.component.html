<div *ngIf="!(dataLoading$ | async)" class="mt-5">
  <div class="row">
    <div class="col-md-3">
      <div class="card radius-15px">
        <!--begin::Card body-->
        <div class="card-toolbar text-end mt-5 pe-5">
          <button class="btn p-0" (click)="openModal(updateImage, 'image')">
            <span class="svg-icon svg-icon-gray me-0 svg-icon-2">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="24px"
                height="24px"
                viewBox="0 0 24 24"
                version="1.1"
              >
                <g
                  stroke="none"
                  stroke-width="1"
                  fill="none"
                  fill-rule="evenodd"
                >
                  <rect x="0" y="0" width="24" height="24" />
                  <path
                    d="M8,17.9148182 L8,5.96685884 C8,5.56391781 8.16211443,5.17792052 8.44982609,4.89581508 L10.965708,2.42895648 C11.5426798,1.86322723 12.4640974,1.85620921 13.0496196,2.41308426 L15.5337377,4.77566479 C15.8314604,5.0588212 16,5.45170806 16,5.86258077 L16,17.9148182 C16,18.7432453 15.3284271,19.4148182 14.5,19.4148182 L9.5,19.4148182 C8.67157288,19.4148182 8,18.7432453 8,17.9148182 Z"
                    fill="#000000"
                    fill-rule="nonzero"
                    transform="translate(12.000000, 10.707409) rotate(-135.000000) translate(-12.000000, -10.707409) "
                  />
                  <rect
                    fill="#000000"
                    opacity="0.3"
                    x="5"
                    y="20"
                    width="15"
                    height="2"
                    rx="1"
                  />
                </g>
              </svg>
            </span>
          </button>
        </div>
        <div
          class="card-body d-flex flex-center flex-column px-9 radius-8px py-9"
        >
          <!--begin::Avatar-->
          <div class="symbol symbol-125px symbol-circle mb-5 profile-pic">
            <span *ngIf="!profileDetails?.imageUrl"
              class="symbol-label fs-3x fw-bold text-white yellow-bg yellow-light-border"
            >
              {{ profileDetails?.organizationName.charAt(0)
              }}
            </span>
            <img src="{{profileDetails?.imageUrl}}" *ngIf="profileDetails?.imageUrl">
          </div>
          <!--begin::Name-->
          <span class="fs-2 text-dark fw-bolder mb-5">
            {{ profileDetails?.organizationName }}
          </span>
          <!--end::Name-->
          <!--end::Avatar-->
          <div class="card-toolbar mb-5">
            <span class="badge light-green-badge fw-bolder me-auto px-4 py-2">
              Verified
            </span>
          </div>
        </div>
        <!--begin::Card body-->
      </div>
    </div>
    <div class="col-md-9">
      <div class="card radius-15px">
        <div class="card-header border-0 pt-5">
          <div class="card-title mt-3">
            <span class="card-label fw-bolder fs-3 mb-1">Profile</span>
          </div>
          <button class="btn p-0" (click)="openModal(editProfile, 'profile')">
            <span class="svg-icon svg-icon-gray me-0 svg-icon-2">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                width="24px"
                height="24px"
                viewBox="0 0 24 24"
                version="1.1"
              >
                <g
                  stroke="none"
                  stroke-width="1"
                  fill="none"
                  fill-rule="evenodd"
                >
                  <rect x="0" y="0" width="24" height="24" />
                  <path
                    d="M8,17.9148182 L8,5.96685884 C8,5.56391781 8.16211443,5.17792052 8.44982609,4.89581508 L10.965708,2.42895648 C11.5426798,1.86322723 12.4640974,1.85620921 13.0496196,2.41308426 L15.5337377,4.77566479 C15.8314604,5.0588212 16,5.45170806 16,5.86258077 L16,17.9148182 C16,18.7432453 15.3284271,19.4148182 14.5,19.4148182 L9.5,19.4148182 C8.67157288,19.4148182 8,18.7432453 8,17.9148182 Z"
                    fill="#000000"
                    fill-rule="nonzero"
                    transform="translate(12.000000, 10.707409) rotate(-135.000000) translate(-12.000000, -10.707409) "
                  />
                  <rect
                    fill="#000000"
                    opacity="0.3"
                    x="5"
                    y="20"
                    width="15"
                    height="2"
                    rx="1"
                  />
                </g>
              </svg>
            </span>
          </button>
        </div>
        <div class="card-body pt-0">
          <table
            class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-7 mb-3"
          >
            <tbody>
              <tr class="">
                <td>
                  <span class="svg-icon svg-icon-gray svg-icon-2 me-5">
                    <img
                      src="./assets/media/icons/briefcase.png"
                      alt="envelope"
                    />
                  </span>
                  <span class="text-gray-500 fw-bold"> Name </span>
                </td>
                <td>
                  <span class="text-gray-500 fw-medium">
                    {{ profileDetails?.firstName }}
                    {{ profileDetails?.lastName }}
                  </span>
                </td>
              </tr>
              <tr class="">
                <td>
                  <span class="svg-icon svg-icon-gray svg-icon-2 me-5">
                    <img
                      src="./assets/media/icons/envelope.png"
                      alt="envelope"
                    />
                  </span>
                  <span class="text-gray-500 fw-bold"> Email </span>
                </td>
                <td>
                  <span class="text-gray-500 fw-medium">
                    {{ profileDetails?.username }}
                  </span>
                </td>
              </tr>
              <tr class="">
                <td>
                  <span class="svg-icon svg-icon-gray svg-icon-2 me-5">
                    <img src="./assets/media/icons/mob.png" alt="envelope" />
                  </span>
                  <span class="text-gray-500 fw-bold"> Phone </span>
                </td>
                <td>
                  <span class="text-gray-500 fw-medium">
                    {{ profileDetails?.phoneNumber }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="card mt-7 radius-15px py-3">
    <div class="card-header border-0 mb-0">
      <div class="card-title mt-3">
        <h4 class="fs-3 fw-bolder">Updatera Global m책l</h4>
      </div>
      <div class="card-toolbar text-end mt-5 pe-5">
        <button
          class="btn p-0"
          (click)="openModal(preferencesModal, 'preferences')"
        >
          <span class="svg-icon svg-icon-gray me-0 svg-icon-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              width="24px"
              height="24px"
              viewBox="0 0 24 24"
              version="1.1"
            >
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <rect x="0" y="0" width="24" height="24" />
                <path
                  d="M8,17.9148182 L8,5.96685884 C8,5.56391781 8.16211443,5.17792052 8.44982609,4.89581508 L10.965708,2.42895648 C11.5426798,1.86322723 12.4640974,1.85620921 13.0496196,2.41308426 L15.5337377,4.77566479 C15.8314604,5.0588212 16,5.45170806 16,5.86258077 L16,17.9148182 C16,18.7432453 15.3284271,19.4148182 14.5,19.4148182 L9.5,19.4148182 C8.67157288,19.4148182 8,18.7432453 8,17.9148182 Z"
                  fill="#000000"
                  fill-rule="nonzero"
                  transform="translate(12.000000, 10.707409) rotate(-135.000000) translate(-12.000000, -10.707409) "
                />
                <rect
                  fill="#000000"
                  opacity="0.3"
                  x="5"
                  y="20"
                  width="15"
                  height="2"
                  rx="1"
                />
              </g>
            </svg>
          </span>
        </button>
      </div>
    </div>
    <div class="card-body d-flex justify-content-start pt-0 flex-wrap pb-3">
      <span
        *ngFor="let data of selectedCategories"
        class="yellow-light-bg d-flex flex-column align-items-center justify-content-center p-5 pt-5 pb-3 rounded-card me-5 w-150px radius-8px mb-5"
      >
        <img
          src="./assets/media/categories/{{ data?.id }}-icon.png"
          class="w-50px radius-8px"
          alt=" camera.png"
        />
        <span
          class="text-gray-700 d-block mt-2 fs-8 bold h-40px overflow-hidden text-center"
          >{{ data?.name }}</span
        >
      </span>
    </div>
  </div>
</div>

<div
  class="col text-center data-loader mt-5 p-5 pt-7"
  *ngIf="dataLoading$ | async"
>
  <div class="spinner-border text-warning" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<!--edit profile modal-->
<ng-template #editProfile let-modal>
  <div class="modal-header px-7">
    <h4 class="modal-title fw-bolder fs-3" id="modal-basic-title">
      Edit Profile
    </h4>
  </div>
  <div class="modal-body">
    <form [formGroup]="form" autocomplete="off" novalidate>
      <div class="fv-row mb-10">
        <div class="d-flex justify-content-between">
          <div class="d-flex flex-stack mb-2">
            <label class="form-label fw-medium text-gray-400 fs-6 mb-0 required"
              >First Name</label
            >
          </div>
        </div>

        <input
          class="form-control form-control-lg border-gray-200 h-40 px-4 fs-6"
          type="text"
          name="firstName"
          autocomplete="off"
          formControlName="firstName"
        />
        <div *ngIf="form.get('firstName')?.touched">
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="form.get('firstName')?.hasError('required')"
          >
            First name is required
          </div>
        </div>
      </div>

      <div class="fv-row mb-10">
        <div class="d-flex justify-content-between mt-n5">
          <div class="d-flex flex-stack mb-2">
            <label class="form-label fw-medium text-gray-400 fs-6 mb-0 required"
              >Last Name</label
            >
          </div>
        </div>

        <input
          class="form-control form-control-lg border-gray-200 h-40 px-4 fs-6"
          type="text"
          name="lastName"
          autocomplete="off"
          formControlName="lastName"
        />
        <div
          class="fv-plugins-message-container invalid-feedback"
          *ngIf="
            form.get('lastName')?.hasError('required') &&
            form.get('lastName')?.touched
          "
        >
          Last name is required
        </div>
      </div>

      <div class="fv-row mb-10">
        <div class="d-flex justify-content-between mt-n5">
          <div class="d-flex flex-stack mb-2">
            <label class="form-label fw-medium text-gray-400 fs-6 mb-0 required"
              >Phone Number</label
            >
          </div>
        </div>

        <input
          class="form-control form-control-lg border-gray-200 h-40 px-4 fs-6"
          type="text"
          name="phoneNumber"
          autocomplete="off"
          formControlName="phoneNumber"
        />
        <div *ngIf="form.get('phoneNumber')?.touched">
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="form.get('phoneNumber')?.hasError('required')"
          >
            Phone number is required
          </div>
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="
              form.get('phoneNumber')?.hasError('maxlength') ||
              form.get('phoneNumber')?.hasError('minlength')
            "
          >
            Invalid phone number is not allowed
          </div>
        </div>
      </div>

      <div class="fv-row mb-10">
        <div class="d-flex justify-content-between mt-n5">
          <div class="d-flex flex-stack mb-2">
            <label class="form-label fs-6 text-gray-400 fw-medium required mb-0"
              >Organization Name</label
            >
          </div>
        </div>
        <input
          class="form-control form-control-lg border-gray-200 h-40 px-4 fs-6"
          type="text"
          name="organizationName"
          formControlName="organizationName"
          autocomplete="off"
        />
        <div *ngIf="form.get('organizationName')?.touched">
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="form.get('organizationName')?.hasError('required')"
          >
            Organization name is required
          </div>
        </div>
      </div>

      <div class="fv-row mb-5">
        <div class="d-flex justify-content-between mt-n5">
          <div class="d-flex flex-stack mb-2">
            <label class="form-label fw-medium text-gray-400 fs-6 mb-0 required"
              >Organization Number</label
            >
          </div>
        </div>

        <input
          class="form-control form-control-lg border-gray-200 h-40 px-4 fs-6"
          type="text"
          name="organizationNumber"
          autocomplete="off"
          formControlName="organizationNumber"
          mask="000000-0000"
          [showMaskTyped]="true"
        />
        <div *ngIf="form.get('organizationNumber')?.touched">
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="form.get('organizationNumber')?.hasError('required')"
          >
            Organization number is required
          </div>
          <div
            class="fv-plugins-message-container invalid-feedback"
            *ngIf="
              form.get('organizationNumber')?.hasError('maxlength') ||
              form.get('organizationNumber')?.hasError('minlength')
            "
          >
            Invalid organization number is not allowed
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer justify-content-center">
    <button
      type="button"
      class="btn btn-light w-175px"
      (click)="modal.close('Save click')"
      [disabled]="btnPrefLoading$ | async"
    >
      Discard
    </button>
    <button
      type="button"
      class="btn yellow-button w-175px"
      (click)="onClickEditUpdate(modal)"
      [disabled]="btnPrefLoading$ | async"
    >
      <ng-container *ngIf="btnPrefLoading$ | async">
        <span class="indicator-progress" [style.display]="'block'">
          Please wait...
          <span
            class="spinner-border spinner-border-sm align-middle ms-2"
          ></span>
        </span>
      </ng-container>
      <ng-container *ngIf="!(btnPrefLoading$ | async)">
        <span class="indicator-label">Update</span>
      </ng-container>
    </button>
  </div>
</ng-template>
<!--edit profile modal-->

<!--edit profile perfrences modal-->
<ng-template #preferencesModal let-modal>
  <div class="modal-header px-10">
    <h4 class="modal-title fw-bolder fs-3" id="modal-basic-title">
      Updatera Globala m책l
    </h4>
  </div>
  <div class="modal-body py-19">
    <label class="mb-8 fs-6 text-gray-400">V채lj Globala m책l</label>
    <div class="card">
      <!--begin::Card body-->

      <ng-multiselect-dropdown
        [placeholder]="'Select Preferences'"
        [settings]="dropdownSettings"
        [data]="dropdownList"
        [(ngModel)]="updatedCategories"
      >
      </ng-multiselect-dropdown>

      <!--begin::Card body-->
    </div>
  </div>
  <div class="modal-footer justify-content-center">
    <button
      type="button"
      class="btn btn-light w-150px"
      (click)="modal.close('Save click')"
      [disabled]="btnPrefLoading$ | async"
    >
      Discard
    </button>
    <button
      type="button"
      class="btn yellow-button w-175px"
      (click)="onUpdatePreferences(modal)"
      [disabled]="btnPrefLoading$ | async"
    >
      <ng-container *ngIf="btnPrefLoading$ | async">
        <span class="indicator-progress" [style.display]="'block'">
          Please wait...
          <span
            class="spinner-border spinner-border-sm align-middle ms-2"
          ></span>
        </span>
      </ng-container>
      <ng-container *ngIf="!(btnPrefLoading$ | async)">
        <span class="indicator-label">Update</span>
      </ng-container>
    </button>
  </div>
</ng-template>
<!--edit profile modal-->

<!--edit profile image modal-->
<ng-template #updateImage let-modal>
  <div class="modal-header px-10">
    <h4 class="modal-title fw-bolder" id="modal-basic-title">
      Update Profile Image
    </h4>
  </div>
  <div class="modal-body">
    <div class="card">
      <div class="fv-row mb-10">
        <label class="form-label fs-8 text-gray-400 fw-medium fs-8 required"
          >Image Url*</label
        >
        <input
          class="form-control form-control-lg border-gray-400 h-40"
          type="text"
          name="logoUrl"
          [(ngModel)]="logoUrl"
          autocomplete="off"
        />
        <div class="fv-plugins-message-container">
          Only .png, .jpg and .jpeg files are allowed
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-light w-150px"
      (click)="modal.close('Save click')"
      [disabled]="btnPrefLoading$ | async"
    >
      Avbryt
    </button>
    <button
      type="button"
      class="btn yellow-button w-150px"
      (click)="onUpdateLogoImage(modal)"
      [disabled]="btnPrefLoading$ | async"
    >
      <ng-container *ngIf="btnPrefLoading$ | async">
        <span class="indicator-progress" [style.display]="'block'">
          Please wait...
          <span
            class="spinner-border spinner-border-sm align-middle ms-2"
          ></span>
        </span>
      </ng-container>
      <ng-container *ngIf="!(btnPrefLoading$ | async)">
        <span class="indicator-label">Uppdatera</span>
      </ng-container>
    </button>
  </div>
</ng-template>
<!--edit profile image modal-->
